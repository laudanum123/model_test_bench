{% extends "base.html" %}

{% block title %}Questions - Model Test Bench{% endblock %}

{% block content %}
<div class="row">
    <div class="col-12">
        <h2 class="mb-4">
            <i class="fas fa-question-circle me-2"></i>Questions
        </h2>
    </div>
</div>
<div class="row mb-3">
    <div class="col-md-6">
        <label for="questions-corpus-select" class="form-label">Select Corpus</label>
        <select class="form-select" id="questions-corpus-select">
            <option value="">Select a corpus...</option>
        </select>
    </div>
</div>
<div class="row">
    <div class="col-12">
        <div class="card">
            <div class="card-body">
                <div id="questions-list">
                    <p class="text-muted">Select a corpus to view questions.</p>
                </div>
            </div>
        </div>
    </div>
</div>
{% endblock %}

{% block extra_js %}
<script>
    // Questions-specific JavaScript
    async function loadCorporaForQuestions() {
        try {
            const response = await axios.get('/corpus/');
            const select = document.getElementById('questions-corpus-select');
            select.innerHTML = '<option value="">Select a corpus...</option>';
            response.data.forEach(corpus => {
                const option = document.createElement('option');
                option.value = corpus.id;
                option.textContent = corpus.name;
                select.appendChild(option);
            });
        } catch (error) {
            console.error('Error loading corpora for questions:', error);
        }
    }

    async function loadQuestionsForCorpus(corpusId) {
        const questionsList = document.getElementById('questions-list');
        if (!corpusId) {
            questionsList.innerHTML = '<p class="text-muted">Select a corpus to view questions.</p>';
            return;
        }
        try {
            const response = await axios.get(`/questions/?corpus_id=${corpusId}`);
            const questions = response.data;
            if (questions.length === 0) {
                questionsList.innerHTML = '<p class="text-muted">No questions found for this corpus.</p>';
                return;
            }
            const html = questions.map(q => `
                <div class="mb-3">
                    <strong>Q:</strong> ${q.question_text}<br>
                    <strong>Reference Answer:</strong> ${q.reference_answer || 'N/A'}<br>
                    <small class="text-muted">Generated by: ${q.generated_by}</small>
                </div>
            `).join('');
            questionsList.innerHTML = html;
        } catch (error) {
            questionsList.innerHTML = '<p class="text-danger">Error loading questions.</p>';
        }
    }

    // Initialize when page loads
    document.addEventListener('DOMContentLoaded', function() {
        loadCorporaForQuestions();
        document.getElementById('questions-corpus-select').addEventListener('change', function() {
            loadQuestionsForCorpus(this.value);
        });
    });
</script>
{% endblock %} 